<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Quản lý trạng thái Pokémon - NXC Scarlet</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="wrap">
    <header>
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div>
      <h1>Quản lý trạng thái Pokémon</h1>
      <p class="lead">Upload danh sách tài khoản 1 lần → chọn sản phẩm → quét trạng thái (demo).</p>
        </div>
        <div id="gmailAccountInfo" style="text-align:right;">
          <button id="gmailSignInBtnHeader" class="btn">Đăng nhập Gmail</button>
        </div>
      </div>
    </header>

    <section class="controls">
      <div class="left">
        <label class="muted">Tài khoản (.txt, 1 email/dòng)</label>
        <div class="row">
          <input id="fileInput" type="file" accept=".txt" />
          <button id="clearAccounts" class="btn ghost">Xóa danh sách</button>
        </div>
        <div id="accountCount" class="muted">Chưa có tài khoản</div>
      </div>

      <div class="right">
        <label class="muted">Sản phẩm</label>
        <div class="row">
          <select id="productSelect"><option value="">-- Chưa có sản phẩm --</option></select>
          <button id="editProductsBtn" class="btn">Chỉnh sửa</button>
          <button id="exportCsv" class="btn ghost">Export CSV</button>
        </div>
        <div class="row small" style="margin-top:12px;">
          <label class="muted">Từ</label>
          <input id="dateFrom" type="date">
          <label class="muted">Đến</label>
          <input id="dateTo" type="date">
        </div>
        <div class="row small">
          <button id="gmailScanBtn" class="btn primary">Quét Gmail</button>
        </div>
      </div>
    </section>

    <section class="tablewrap">
      <div id="scanProgress" class="scan-progress hidden"></div>
      <table id="resultTable">
        <thead>
          <tr>
            <th>STT</th>
            <th>Tên tài khoản</th>
            <th>Ứng tuyển</th>
            <th>Kết quả</th>
            <th>Mua</th>
            <th>Bị hủy</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="empty" class="muted">Chưa có dữ liệu. Hãy upload file tài khoản.</div>
    </section>

    <footer class="muted">NXC Scarlet — Pokémon Account Manager (Demo). Dữ liệu lưu cục bộ trong trình duyệt (localStorage).</footer>
  </div>

  <!-- Modal Thêm sản phẩm -->
  <div id="modal" class="modal hidden" role="dialog" aria-hidden="true">
    <div class="modal-box">
      <h3>Thêm sản phẩm</h3>
      <label>Tên sản phẩm</label>
      <input id="prodName" type="text" placeholder="Ví dụ: Pikachu Plush A">
      <label>ID sản phẩm (dùng để quét trong email)</label>
      <input id="prodId" type="text" placeholder="Ví dụ: PIKA-A-2025">
      <div class="row" style="justify-content:flex-end;margin-top:12px;">
        <button id="saveProduct" class="btn">Lưu</button>
        <button id="cancelProduct" class="btn ghost">Hủy</button>
      </div>
    </div>
  </div>

  <!-- Modal Quản lý sản phẩm -->
  <div id="editProductsModal" class="modal hidden" role="dialog" aria-hidden="true">
    <div class="modal-box" style="width:600px;">
      <h3>Quản lý sản phẩm</h3>
      <table style="width:100%;margin-top:12px;border-collapse:collapse;">
        <thead>
          <tr style="border-bottom:1px solid rgba(255,255,255,0.1);">
            <th style="padding:8px;text-align:left;">Tên sản phẩm</th>
            <th style="padding:8px;text-align:left;">Mã ID</th>
            <th style="padding:8px;text-align:center;width:100px;">Thao tác</th>
          </tr>
        </thead>
        <tbody id="productsListBody">
        </tbody>
      </table>
      <div class="row" style="justify-content:flex-end;margin-top:12px;">
        <button id="addProductInEditModal" class="btn">＋ Thêm sản phẩm</button>
        <button id="closeEditProductsModal" class="btn ghost">Đóng</button>
      </div>
    </div>
  </div>

<script src="https://apis.google.com/js/api.js" onload="gapiLoaded()" onerror="console.error('Failed to load gapi script')"></script>
<script src="https://accounts.google.com/gsi/client" async defer onload="gisLoaded()" onerror="console.error('Failed to load GIS script')"></script>
<script src="script.js"></script>
</body>
</html>
